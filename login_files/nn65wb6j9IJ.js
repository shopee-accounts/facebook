if (self.CavalryLogger) { CavalryLogger.start_js(["6Lwg8"]); }

__d("MLoginFormSigils",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={FORM:"m_login_form",BUTTON:"m_login_button",NOTICE:"m_login_notice",UPSELL:"m_login_upsell",EMAIL_INPUT:"m_login_email",PASSWORD_INPUT:"m_login_password"};},null);
__d("arrayContains",[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i,j){return i.indexOf(j)!==-1;}f.exports=h;},null);
__d("cssURL",[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i){return "url('"+i.replace(/(\\|\s|\(|\)|'|\")/g,'\\$1')+"')";}f.exports=h;},null);
__d('isEmpty',['invariant'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();function i(k){if(Array.isArray(k)){return k.length===0;}else if(typeof k==='object'){if(k){!(!j(k)||k.size===undefined)?h(0):void 0;for(var l in k)return false;}return true;}else return !k;}function j(k){if(typeof Symbol==='undefined')return false;return k[typeof Symbol==='function'?Symbol.iterator:'@@iterator'];}f.exports=i;},null);
__d('LeftRight.react',['React','cx','invariant','keyMirror','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k,l){var m,n;if(c.__markCompiled)c.__markCompiled();var o=k({left:true,right:true,both:true});function p(s){!(s&&(s.length===1||s.length===2))?j(0):void 0;}function q(s){var t=[];h.Children.forEach(s,function(u){t.push(u);},this);return t;}m=babelHelpers.inherits(r,h.Component);n=m&&m.prototype;r.prototype.render=function(){'use strict';var s=q(this.props.children);p(s);var t=this.props.direction||o.both,u=t===o.both,v=u||t===o.left?"_ohe lfloat":'',w=u||t===o.right?"_ohf rfloat":'',x=h.createElement('div',{key:'left',className:v},s[0]),y=s.length<2?null:h.createElement('div',{key:'right',className:w},s[1]),z=t===o.right&&y?[y,x]:[x,y];return (h.createElement('div',babelHelpers['extends']({},this.props,{className:l(this.props.className,"clearfix")}),z));};function r(){'use strict';m.apply(this,arguments);}r.DIRECTION=o;f.exports=r;},null);
__d('TokenizeUtil',[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=/[ ]+/g,i=/[^ ]+/g,j=new RegExp(k(),'g');function k(){return '[.,+*?$|#{}()\'\\^\\-\\[\\]\\\\\\/!@%"~=<>_:;'+'\u30fb\u3001\u3002\u3008-\u3011\u3014-\u301f\uff1a-\uff1f\uff01-\uff0f'+'\uff3b-\uff40\uff5b-\uff65\u2E2E\u061f\u066a-\u066c\u061b\u060c\u060d'+'\uFD3e\uFD3F\u1801\u0964\u104a\u104b\u2010-\u2027\u2030-\u205e'+'\u00a1-\u00b1\u00b4-\u00b8\u00ba\u00bb\u00bf]';}var l={},m={a:"\u0430 \u00e0 \u00e1 \u00e2 \u00e3 \u00e4 \u00e5 \u0101",b:"\u0431",c:"\u0446 \u00e7 \u010d",d:"\u0434 \u00f0 \u010f \u0111",e:"\u044d \u0435 \u00e8 \u00e9 \u00ea \u00eb \u011b \u0113",f:"\u0444",g:"\u0433 \u011f \u0123",h:"\u0445 \u0127",i:"\u0438 \u00ec \u00ed \u00ee \u00ef \u0131 \u012b",j:"\u0439",k:"\u043a \u0138 \u0137",l:"\u043b \u013e \u013a \u0140 \u0142 \u013c",m:"\u043c",n:"\u043d \u00f1 \u0148 \u0149 \u014b \u0146",o:"\u043e \u00f8 \u00f6 \u00f5 \u00f4 \u00f3 \u00f2",p:"\u043f",r:"\u0440 \u0159 \u0155",s:"\u0441 \u015f \u0161 \u017f",t:"\u0442 \u0165 \u0167 \u00fe",u:"\u0443 \u044e \u00fc \u00fb \u00fa \u00f9 \u016f \u016b",v:"\u0432",y:"\u044b \u00ff \u00fd",z:"\u0437 \u017e",ae:"\u00e6",oe:"\u0153",ts:"\u0446",ch:"\u0447",ij:"\u0133",sh:"\u0448",ss:"\u00df",ya:"\u044f"};for(var n in m){var o=m[n].split(' ');for(var p=0;p<o.length;p++)l[o[p]]=n;}var q={};function r(x){return x?x.replace(j,' '):'';}function s(x){x=x.toLowerCase();var y='',z='';for(var aa=x.length;aa--;){z=x.charAt(aa);y=(l[z]||z)+y;}return y.replace(h,' ');}function t(x){var y=[],z=i.exec(x);while(z){z=z[0];y.push(z);z=i.exec(x);}return y;}function u(x,y){if(!q.hasOwnProperty(x)){var z=s(x),aa=r(z);q[x]={value:x,flatValue:z,tokens:t(aa),isPrefixQuery:aa&&aa[aa.length-1]!=' '};}if(y&&typeof q[x].sortedTokens=='undefined'){q[x].sortedTokens=q[x].tokens.slice();q[x].sortedTokens.sort(function(ba,ca){return ca.length-ba.length;});}return q[x];}function v(x,y,z){var aa=u(y,x=='prefix'),ba=x=='prefix'?aa.sortedTokens:aa.tokens,ca=u(z).tokens,da={},ea=aa.isPrefixQuery&&x=='query'?ba.length-1:null,fa=function(ga,ha){for(var ia=0;ia<ca.length;++ia){var ja=ca[ia];if(!da[ia]&&(ja==ga||(x=='query'&&ha===ea||x=='prefix')&&ja.indexOf(ga)===0))return da[ia]=true;}return false;};return Boolean(ba.length&&ba.every(fa));}var w={flatten:s,parse:u,getPunctuation:k,isExactMatch:v.bind(null,'exact'),isQueryMatch:v.bind(null,'query'),isPrefixMatch:v.bind(null,'prefix'),tokenize:t};f.exports=w;},null);
__d('DeviceBasedAccount',['JSXDOM','cx'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j={create:function(k,l,m){return (h.div({className:"_5t1x",sigil:"account-container"},h.div({className:"_5t1y"},h.img({src:k,alt:l,className:"_5t1z"})),h.div({className:"_5t1-"},l)));}};f.exports=j;},null);
__d('MDeviceBasedAccountStore',['isEmpty','WebStorage'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j=':userchooser:osessusers',k={accountHasPin:function(l){return k._getAttributeOrNull(l,'is_pin_set')&&true||false;},accountExists:function(l){return k.getAccount(l)&&true||false;},getNonce:function(l){return k._getAttributeOrNull(l,'nonce');},getName:function(l){return k._getAttributeOrNull(l,'name');},getPic:function(l){return k._getAttributeOrNull(l,'pic_url');},getAccount:function(l){var m=k.getAccounts();return m[l];},removeAccount:function(l){var m=k.getAccounts();delete m[l];k._setStorageItem(m);},setAccount:function(l,m){var n=k.getAccounts(),o=n[l];if(o&&o.time>m.time)return;n[l]=m;k._setStorageItem(n);},getAccounts:function(){return k._getStorageItem()||{};},isEmpty:function(){return h(k._getStorageItem());},_getStorageItem:function(){if(!k._hasStorage())return;var l=k._getStorage().getItem(j);return l&&JSON.parse(l);},_setStorageItem:function(l){if(!k._hasStorage())return;var m=k._getStorage();i.setItemGuarded(m,j,JSON.stringify(l));},_hasStorage:function(){return !!k._getStorage();},_getStorage:function(){return i.getLocalStorage();},_getAttributeOrNull:function(l,m){var n=k.getAccount(l);return n&&n[m];}};f.exports=k;},null);
__d("XDeviceBasedLoginRequestPinController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/login\/device-based\/pin\/",{uid:{type:"Int",required:true},next:{type:"String"},errorcode:{type:"Int"},flow:{type:"Enum",defaultValue:"login",enumType:1}});},null);
__d('MLoginChooser',['cx','ge','goURI','isEmpty','DeviceBasedAccount','CSS','DOM','MDeviceBasedAccountStore','MHistory','MViewport','Style','ServiceWorkerLoginAndLogout','Stratcom','URI','XDeviceBasedLoginRequestPinController'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){if(c.__markCompiled)c.__markCompiled();var w=32,x=90,y=12,z=12,aa='traditional-login',ba={initChooser:function(ca,da,ea,fa,ga){var ha=n.scry(i('page'),'div',aa)[0];n.listen(fa,'click',null,this.switchAccountClicked.bind(this,ca,ha));this.render(ca,ha,ea);t.listen('m:viewport:update-complete',null,ba.chooserWidthChange.bind(this,ea,x));ba.chooserWidthChange(ea,x);},setUserNonceSuccess:function(ca,da){o.setAccount(ca.id,ca);window.location=da;},removeUserAndRedirect:function(ca,da){o.removeAccount(ca);j(da);},fillWithNonce:function(ca,da){ca.value=o.getNonce(da);},render:function(ca,da,ea){var fa=o.getAccounts();if(k(fa))return;for(var ga in fa){var ha=l.create(o.getPic(ga),o.getName(ga),o.accountHasPin(ga));n.appendContent(ea,ha);n.listen(ha,'click',null,this.userClicked.bind(this,ca,ga));}var ia=document.getElementById('root');m.addClass(ia,"_5t66");var ja=document.getElementById('header');m.addClass(ja,"_5t68");m.show(ca);m.hide(da);},userClicked:function(ca,da){s.login();if(o.accountHasPin(da)===false){if(this.enabled!==false){this.enabled=false;var ea=n.find(ca,'form','device-based-login-form');this.fillAndSubmitForm(ea,da);setTimeout(this.enableForm.bind(this),5000);}}else{var fa=new u(p.getPath()),ga=fa.getQueryData().next,ha=v.getURIBuilder().setInt('uid',da).setString('next',ga).getURI();p.pushState(ha);}},enableForm:function(){this.enabled=true;},fillAndSubmitForm:function(ca,da){var ea=ca.querySelector("input[name='uid']");ea.value=da;var fa=ca.querySelector("input[name='device_nonce']");fa.value=o.getNonce(da);ca.submit();},switchAccountClicked:function(ca,da){var ea=document.getElementById('root');m.removeClass(ea,"_5t66");var fa=document.getElementById('header');m.removeClass(fa,"_5t68");m.hide(ca);m.show(da);},setupDescription:function(ca){var da=n.find(ca,'div','description'),ea=n.find(ca,'input'),fa=ca.offsetHeight-1,ga=fa-da.offsetHeight;r.set(ca,'height',fa+'px');r.set(da,'position','absolute');r.set(da,'bottom','0');n.listen(ea,'change',null,this.rememberAccountToggleChange.bind(this,ca,ea,fa,ga));setTimeout(m.addClass.bind(m,ca,"_5sri"),20);},chooserWidthChange:function(ca,da){var ea=n.scry(ca,'div','account-container'),fa=ba.calculateChooserPadding(da,ea.length);for(var ga=0;ga<ea.length;ga++){if(ga==ea.length-1)continue;r.set(ea[ga],'padding-right',fa.elements+'px');}r.set(ca,'padding-left',fa.edges+'px');r.set(ca,'padding-right',fa.edges+'px');},rememberAccountToggleChange:function(ca,da,ea,fa){if(da.checked){r.set(ca,'height',ea+'px');}else r.set(ca,'height',fa+'px');},calculateChooserPadding:function(ca,da){var ea=q.getWidth(),fa=ca/4,ga=ca-ca/20,ha=ca+z,ia=ea-w*2,ja=(ia+z)/ha;if(ja>=da)return {edges:w,elements:z};ia=ea-y*2;ja=(ia+z)/ha;if(ja>=da)return {edges:y,elements:z};ia=ea-w;ja=(ia+z)/ha;var ka=0,la=0,ma=ca-ga,na=(ia+z)%ha;if(na>=fa&&na<=ga){ka=Math.ceil(ja);}else if(na<fa){ka=Math.floor(ja);la=na+z+ma;}else{ka=Math.ceil(ja);var oa=ca-na;la=ma-oa;}var pa=la/(ka-1),qa=z+pa;return {edges:w,elements:Math.floor(qa)};}};f.exports=ba;},null);
__d('MLoginFormError',['CSS','DOM','Stratcom','cx','invariant'],function a(b,c,d,e,f,g,h,i,j,k,l){'use strict';if(c.__markCompiled)c.__markCompiled();var m="_3qsy",n="_3qs-",o={set:function(p,q){!(q!==null)?l(0):void 0;h.addClass(p,m);h.addClass(p,n);i.listen(p,'input',null,function(r){h.removeClass(p,n);});},unset:function(p){h.removeClass(p,m);h.removeClass(p,n);}};f.exports=o;},null);
__d('MLoginController',['CSS','cx','DOM','DeferredCookie','Stratcom','MAjaxify','MButton','MDeviceBasedAccountStore','MLoginFormError','MLoginFormSigils','MPasswordPlainTextToggleSigils','ge','isEmpty','Keys'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){'use strict';if(c.__markCompiled)c.__markCompiled();var v="_pg8",w={initLoginForm:function(x,y){if(!t(o.getAccounts()))return;this.loginForm=j.find(x,'form',q.FORM);this.loginForm.action=y;this.loginButton=j.find(x,'button',q.BUTTON);this.loginButton.type='button';this.notice=j.find(x,'div',q.NOTICE);this.emailInput=this._getElem(x,'input',q.EMAIL_INPUT);this.passwordInput=this._getElem(x,'div',q.PASSWORD_INPUT);this.upsell=this._getElem(x,'div',q.UPSELL);j.listen(this.loginButton,'click',null,this._sendLoginRequest.bind(this));j.listen(this.loginForm,'keyup',null,function(z){if(z.getRawEvent().keyCode===u.RETURN)this._sendLoginRequest();}.bind(this));},_getElem:function(x,y,z){var aa=j.scry(x,y,z);if(aa.length===0)return null;return aa[0];},_sendLoginRequest:function(){k.flushAllCookies();h.hide(this.notice);n.setEnabled(this.loginButton,false);setTimeout(n.setEnabled.bind(null,this.loginButton,true),15000);m.form(null,this.loginForm,null,'nocache',null,true,[{response:this._onLoginResponse.bind(this)}]);},_onLoginResponse:function(x){n.setEnabled(this.loginButton,true);if(!x.payload)return;var y=x.payload;if(y[q.NOTICE]){j.setContent(this.notice,y[q.NOTICE]);h.show(this.notice);}if(this.emailInput!==null){if(y[q.EMAIL_INPUT].error){p.set(this.emailInput,'error');}else p.unset(this.emailInput);var z=y[q.EMAIL_INPUT].value;if(z){this.emailInput.value=z;}else this.emailInput.value='';}if(this.passwordInput!==null){j.find(this.passwordInput,'input').value='';l.invoke('m:passwordinput:autoclear',r.INPUT);if(y[q.PASSWORD_INPUT].error){h.addClass(this.passwordInput,v);}else{p.unset(j.find(this.passwordInput,'input'));h.removeClass(this.passwordInput,v);}}if(this.upsell!==null)j.hide(this.upsell);},redirect:function(x){window.location.replace(x);}};f.exports=w;},null);
__d('MContentSearchFilter',['Stratcom'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i={setFilters:function(j){this.markup=j;h.invoke('m-content-search-filter-update',null,{markup:j});},getFilters:function(){var j=this.markup;this.markup=null;return j;}};f.exports=i;},null);
__d('MGraphSearchCompositeSource',['TypeaheadCompositeSource'],function a(b,c,d,e,f,g,h){var i,j;if(c.__markCompiled)c.__markCompiled();i=babelHelpers.inherits(k,h);j=i&&i.prototype;k.prototype.mergeResults=function(l,m){'use strict';var n=j.mergeResults.call(this,l,m);if(!n||!this.$MGraphSearchCompositeSource1||n.some(function(ea){return ea.type==='trending';})||n.some(function(ea){return ea.isRecentSearch;}))return n;n.length=Math.min(n.length,this.$MGraphSearchCompositeSource1.maxResults);if(this.$MGraphSearchCompositeSource1.enableLegacyStyleBucketization)return this.bucketResults(n);var o=false,p=n[0];if(p&&(p.bootstrapped||p.bootstrap||p.type==='user'&&p.cost<this.$MGraphSearchCompositeSource1.minCostForUserToSurfaceAtTop))o=true;var q=false;for(var r=0;r<this.$MGraphSearchCompositeSource1.maxPositionOfEntityToDivideKeywords;r++)if(n[r]&&n[r].type!=='keyword')q=true;var s=[],t=[],u=[],v=null;for(var w=0;w<n.length;w++){v=n[w];if(!(v.bootstrapped&&this.$MGraphSearchCompositeSource1.keepBootstrapped)&&v.type in this.$MGraphSearchCompositeSource1.filterOutTypes)continue;if(v.type==='keyword'){if(!o&&(!q||t.length<this.$MGraphSearchCompositeSource1.maxKeywordAboveEntities)){t.push(v);}else u.push(v);}else s.push(v);}if(this.$MGraphSearchCompositeSource1.overrideKWRankingBehavior){var x,y=t;y.push.apply(y,u);var z=y.slice(0,this.$MGraphSearchCompositeSource1.numKeywordsAboveEntities),aa=y.slice(this.$MGraphSearchCompositeSource1.numKeywordsAboveEntities);n=z;(x=n).push.apply(x,s);if(this.$MGraphSearchCompositeSource1.hasKeywordsBelowEntities){var ba;(ba=n).push.apply(ba,aa);}}else{var ca,da;n=t;(ca=n).push.apply(ca,s);(da=n).push.apply(da,u);}return n;};k.prototype.bucketResults=function(l){'use strict';if(!l.length)return l;var m,n,o=[],p={};for(var q=0,r=l.length;q<r;q++){m=l[q];n=this.getBucketType(m);if(!p[n]){o.push(n);p[n]=[m];}else p[n].push(m);}return o.reduce(function(s,t){return s.concat(p[t]);},[]);};k.prototype.getBucketType=function(l){'use strict';if(l.type==='keyword'||l.is_grammar)return 'keyword';return 'entity';};k.prototype.setConfig=function(l){'use strict';this.$MGraphSearchCompositeSource1=l;};function k(){'use strict';i.apply(this,arguments);}f.exports=k;},null);
__d('MGraphSearchFlickerFix',['SearchMTouchGlobalOptions','URI','fbt'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k=void 0,l=[],m={},n={insert:function(o,p,q){p.forEach(function(ea){ea.isInvalidated=false;});p=n.removeInjected(p);var r=o.length===0,s=p.filter(function(ea){return ea.type==='keyword'&&ea.display.toLowerCase()!==o;}),t=s.filter(function(ea){return ea.display.toLowerCase()!==o;}),u=s.length;if(t.length>1)if(r){l=[];}else l=t.slice(0,2);if(m[o]||q===false||u>=h.defaultNumTopResultsToShow){m[o]=true;if(r){l=[];}else l=t.slice(0,2);return p;}var v=function(){if(x){if(y>=w.length)return 'break';z=w[y++];}else{y=w.next();if(y.done)return 'break';z=y.value;}var ea=z;if(!p.some(function(fa){return fa.display===ea.display;})){ea.isInvalidated=true;p.push(ea);}};for(var w=l,x=Array.isArray(w),y=0,w=x?w:w[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var z,aa=v();if(aa==='break')break;}var ba=p.filter(function(ea){return ea.type!=='keyword';});if(o.length<2||k==null)k=ba[0];if(k==null)return p;var ca=this.createResult(j._("{fullName}\u7684\u76f8\u7247",[j.param('fullName',k.display.toLowerCase())]));p.push(ca);var da=this.createResult(j._("{fullName}\u7684\u8cbc\u6587",[j.param('fullName',k.display.toLowerCase())]));p.push(da);return p;},removeInjected:function(o){return o.filter(function(p){return !p.isInjected;});},createResult:function(o){var p=j._("\u9ede\u6309\u5373\u53ef\u641c\u5c0b Facebook");return {id:String(o),type:'keyword',display:String(o),subtext:p,uri:new i('/foo'),isInvalidated:true,isInjected:true};}};f.exports=n;},null);
__d('MGraphSearchTypeaheadHeaders',['fbt','keyMirror'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j=i({PYMK:null,RECENT:null,SUGGESTED:null,TOP_MATCHES:null,TRENDING:null,GROUP_POPULAR:null,GROUP_SEARCH:null,SUGGESTED_GLOBAL:null,SEE_MORE:null}),k={PYMK:h._("\u4f60\u53ef\u80fd\u8a8d\u8b58\u7684\u670b\u53cb"),RECENT:h._("\u6700\u8fd1\u7684\u641c\u5c0b"),SUGGESTED:h._("\u641c\u5c0b"),TOP_MATCHES:h._("Top Matches"),TRENDING:h._("\u8da8\u52e2"),GROUP_POPULAR:h._("Popular in this group"),GROUP_SEARCH:h._("\u641c\u5c0b\u9019\u500b\u793e\u5718"),SUGGESTED_GLOBAL:h._("\u641c\u5c0b Facebook \u7684\u5168\u90e8")};f.exports={Types:j,Labels:k};},null);
__d('MGraphSearchTypeaheadBucketizer',['MGraphSearchTypeaheadHeaders'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=h.Types,j=20;function k(m){if(m.isTrending&&m.isNullStateSuggestion){return i.TRENDING;}else if(m.isRecentSearch){return i.RECENT;}else if(m.isPYMK){return i.PYMK;}else if(m.isScoped){return m.isNullStateSuggestion?i.GROUP_POPULAR:i.GROUP_SEARCH;}else if(m.isSeeMore){return i.SEE_MORE;}else if(m.type==='keyword'){return i.SUGGESTED;}else return i.TOP_MATCHES;}function l(m){'use strict';m=m||{};this.maxResults=m.maxResults||j;}l.prototype.bucketize=function(m,n,o){'use strict';var p={},q=Math.min(m.length,this.maxResults);if(o)p[i.SUGGESTED]=[];for(var r=0;r<q;r++){var s=m[r],t=k(s);if(!p[t])p[t]=[];p[t].push(s);}if(o&&!p[i.SUGGESTED].length){delete p[i.SUGGESTED];}else if(o&&n)p[i.SUGGESTED]=p[i.SUGGESTED].slice(0,n);return p;};f.exports=l;},null);
__d('MGraphSearchTypeaheadOnDemandSource',['MTypeaheadOnDemandSource','MSearchKeywordsConst','TokenizeUtil','createArrayFromMixed','Stratcom'],function a(b,c,d,e,f,g,h,i,j,k,l){var m,n;if(c.__markCompiled)c.__markCompiled();var o='graph-search-entry-point';m=babelHelpers.inherits(p,h);n=m&&m.prototype;function p(q,r){'use strict';r=r||{};n.constructor.call(this,q,r);this.enableImmediateReturnOfCachedResults=true;this.setNormalizer(function(s){return s.toLowerCase();});this.setSanitizer(function(s){return s;});this.queryCache={};this.groupID=null;this.isScoped=false;this.showSecondaryPhoto=r.showSecondaryPhoto;this.numResultsToFetch=r.numResultsToFetch;l.listen('setCurrentProfileID',o,function(event){if(event.getData().profileID!==this.groupID){this.groupID=event.getData().profileID;this.clearCache();}}.bind(this));}p.prototype.getMatchedResults=function(q){'use strict';var r=q.toLowerCase();while(r.length>0&&!(r in this.queryCache))r=r.substr(0,r.length-1);if(!r)return [];var s=[];if(r===q){s=this.queryCache[q];return this.renderNodes(q,s);}for(var t=0;t<this.queryCache[r].length;t++){var u=this.queryCache[r][t];if(j.isQueryMatch(q,this._raw[u].display))s.push(u);}return this.renderNodes(q,s);};p.prototype.addToLookup=function(q,r){'use strict';this.addToQueryCache(q,r);};p.prototype.addResult=function(q,r){'use strict';var s=q.uid;if(!(s in this._raw)){q=(this.getTransformer()||this._defaultTransformer)(q);this._raw[s]=q;}this._raw[s].idx=q.idx;this.addToQueryCache(s,r);};p.prototype.addToQueryCache=function(q,r){'use strict';if(!this.queryCache[r])this.queryCache[r]=[];if(this.queryCache[r].indexOf(q)===-1)this.queryCache[r].push(q);};p.prototype.setGroupID=function(q){'use strict';this.groupID=q;};p.prototype.setIsScoped=function(q){'use strict';this.isScoped=q;};p.prototype.getAuxiliaryData=function(){'use strict';var q={};if(this.isScoped&&this.groupID!=null)q.group_id=this.groupID;return babelHelpers['extends']({max_results:this.numResultsToFetch},q);};p.prototype.tokenize=function(q){'use strict';var r=n.tokenize.call(this,q);if(r[r.length-1]==='')r.pop();return r;};p.prototype.ondata=function(q,r,s){'use strict';if(s.payload.results){l.invoke('MGraphSearchTypeaheadOnDemandSource:keywordsLimitUpdate',null,{keywordsLimit:s.payload.num_topresults_to_show,value:r});if(r)r=r.toLowerCase();n.ondata.call(this,q,r,k(s.payload.results));}else{this.invoke('req_recv',0);this.invoke('complete');}};p.prototype.getTransformer=function(){'use strict';var q=this.showSecondaryPhoto;return function(r){if(r.type==='keyword'){var s={cost:r.cost,idx:r.idx,display:r.text,name:r.text,type:r.untranslated_type||r.type,id:r.uid,uri:r.path,saved_context:r.saved_context,logInfo:r.logInfo,subtext:r.subtext,is_grammar:r.grammar_type!=null,isScoped:r.is_scoped,boldedSubtext:r.boldedSubtext,keywordBoldedSubtext:r.keywordBoldedSubtext,keywordRenderType:r.keywordRenderType,secondaryPhoto:r.photo,showSecondaryPhoto:r.photo!=null&&q,keyword_type:r.keyword_type},t=i.keywordTypes;Object.keys(i.keywordTypes).map(function(u){var v='is'+u.charAt(0).toUpperCase()+u.slice(1);s[v]=r.keyword_type===t[u];});i.intentKeys.map(function(u){s.isSpecialIntent=s.isSpecialIntent||s[u];});return s;}return {name:r.text,uri:r.path,id:r.uid,display:r.display||r.text,photo:r.photo,category:r.category,cost:r.cost,idx:r.idx,tokens:r.tokens,type:r.untranslated_type||r.type,verticalType:r.vertical_type,subtext:r.subtext,saved_context:r.saved_context,isVerified:r.is_verified,showGrayCheck:r.show_gray_check,logInfo:r.logInfo};};};p.prototype.clearCache=function(){'use strict';n.clearCache.call(this);this.queryCache={};};f.exports=p;},null);
__d('MGraphSearchTypeaheadResult.react',['cssURL','cx','fbt','MSearchConst','React'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m=' \u00B7 ',n=l.createClass({displayName:'MGraphSearchTypeaheadResult',render:function(){var o=this.props.result.subtext,p=this.props.result.display;if(this.props.result.isSeeMore)p=j._("\u67e5\u770b\u66f4\u591a\u6709\u95dc{query}\u7684\u7d50\u679c",[j.param('query','"'+p+'"')]);var q='',r=this.props.typeaheadConfig.hasSkittlesTA,s=this.props.result.boldedSubtext;if(r&&s)s=l.createElement('span',{className:"_53sg"},this.props.result.boldedSubtext);if(this.props.result.saved_context&&o){q=l.createElement('span',{className:"_2gau"},this.props.result.saved_context);o=m+o;}var t=this.props.forceLongBorder,u=this.props.vertical===k.feed_search&&this.props.result.type==='keyword',v="_1_oa"+(this.props.result.isInvalid?' '+"_s5k":'')+(this.props.result.isSeeMore?' '+"_bju":'')+(r?' '+"_4gvh":'')+(this.props.result.isSpecialIntentGeneric?' '+"_4gvi":'')+(this.props.result.isVideos?' '+"_4gvj":'')+(this.props.result.isPhotos?' '+"_4gvk":'')+(this.props.result.isTrending||this.props.result.isTrending?' '+"_4gvl":'')+(this.props.result.isPeople?' '+"_4gvm":'')+(this.props.result.isHashtag?' '+"_4gvn":'')+(this.props.result.isLocal&&!this.props.typeaheadConfig.useLocalBlueIcon?' '+"_4tt2":'')+(this.props.result.isLocal&&this.props.typeaheadConfig.useLocalBlueIcon?' '+"_2rxl":'')+(' '+"_1w-s")+(this.props.result.isTrending&&!r?' '+"_1_ob":'')+(this.props.result.showSecondaryPhoto?' '+"_4j1z":'')+(this.props.result.isVerified?' '+"_21tt":'')+(this.props.result.showGrayCheck?' '+"_v27":'')+(!!o||!!s?' '+"_1_oc":'')+(this.props.result.photo!=null?' '+"_1_od":'')+(u?' '+"_18ka":'')+(t?' '+"_bmx":'')+(this.props.result.isInvalidated===true?' '+"_348k":''),w=(this.props.result.showSecondaryPhoto?"_4j21":'')+(' '+"_5h5e")+(this.props.result.isTrending&&!this.props.result.isVerified?' '+"_22wu":'')+(!this.props.result.isTrending&&this.props.result.isVerified?' '+"_22wv":'')+(this.props.result.isTrending&&this.props.result.isVerified?' '+"_22ww":''),x=u,y=null;if(this.props.vertical!==k.content_search)y=l.createElement('div',{className:"_38c2",onTouchStart:this.props.onAddToInputClick,onMouseDown:this.props.onAddToInputClick});return (l.createElement('div',{className:v},l.createElement('div',{className:(!this.props.result.showSecondaryPhoto?"_w_1":'')+(this.props.result.showSecondaryPhoto?' '+"_4j22":'')},l.createElement('a',{className:"touchable"+(' '+"_4rh3"),href:this.props.result.uriWithSession,rel:this.props.result.id,onClick:this.props.onClick,'data-sigil':'touchable',style:{display:this.props.visible?'':'none'}},l.createElement('i',{className:"img"+(u?' '+"_15i9":''),style:{display:x?'block':'none'}}),l.createElement('div',{className:"_1_oe"},l.createElement('span',{className:w},p),l.createElement('i',{className:"_21tu img"}),l.createElement('i',{className:"_v28 img"}),l.createElement('i',{className:"_4j23 img"})),l.createElement('div',{className:"_1_og"},q,s,s&&o?m:null,o),this.renderPhoto(),this.renderSecondaryPhoto()),y)));},renderPhoto:function(){if(this.props.result.isTrending&&!this.props.typeaheadConfig.hasSkittlesTA)return (l.createElement('i',{className:"img _1_of _1_oh"}));var o=this.props.result.photo?h(this.props.result.photo):'none';return (l.createElement('i',{className:"_1_oh",style:{backgroundImage:o}}));},renderSecondaryPhoto:function(){var o=this.props.result;if(o.secondaryPhoto&&o.showSecondaryPhoto){var p=h(o.secondaryPhoto);return (l.createElement('i',{className:"_4j24",style:{backgroundImage:p}}));}return null;}});f.exports=n;},null);
__d('MGraphSearchTypeaheadTouchSource',['MTypeaheadTouchSource','createArrayFromMixed'],function a(b,c,d,e,f,g,h,i){var j,k;if(c.__markCompiled)c.__markCompiled();j=babelHelpers.inherits(l,h);k=j&&j.prototype;l.prototype.ondata=function(m){'use strict';this.setNormalizer(function(n){return n.toLowerCase();});k.ondata.call(this,i(m.payload||m));};l.prototype.checkFragmentMatches=function(m,n,o,p){'use strict';if(m.substr(0,n.length)!==n)return false;var q=o[o.length-1]!==' ';if(!q||n!==p)return m==n;return true;};l.prototype.tokenize=function(m){'use strict';var n=k.tokenize.call(this,m);if(n[n.length-1]==='')n.pop();return n;};l.prototype.getTransformer=function(){'use strict';return function(m){return {name:m.text,uri:m.path,id:m.uid,display:m.display||m.text,photo:m.photo,category:m.category,cost:m.cost,idx:m.idx,tokens:m.tokens,type:m.untranslated_type||m.type,verticalType:m.vertical_type,subtext:m.text_only_subtext,logInfo:m.logInfo,bootstrapped:true,saved_context:m.saved_context};};};function l(){'use strict';j.apply(this,arguments);}f.exports=l;},null);
__d("XGroupSearchResultsController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/groups\/search\/",{groupID:{type:"Int"},query:{type:"String"},name:{type:"String"},cursor:{type:"String"},source:{type:"String"}});},null);
__d('MGraphSearchTypeahead.react',['$','CSS','DOM','DOMContainer.react','EventListener','LeftRight.react','MContentSearchFilter','MGraphSearchCompositeSource','MGraphSearchFlickerFix','MGraphSearchTypeaheadBucketizer','MGraphSearchTypeaheadHeaders','MGraphSearchTypeaheadOnDemandSource','MGraphSearchTypeaheadResult.react','MGraphSearchTypeaheadTouchSource','MGraphSearchTypeaheadUtils','MHistory','MJewel','MJewels','MNavTabs','MPageController','MRecentSearchesUpdater','MSearchConst','MSearchTrendingLogger','MSearchTypeaheadLogger','MSearchTypeaheadPerfLogger','MTouchClick','MTypeaheadNullstateSource','MViewport','Parent','React','ReactDOM','SearchMTouchGlobalOptions','Stratcom','Style','SubscriptionsHandler','URI','XGroupSearchResultsController','arrayContains','clearTimeout','csx','cx','fbt','invariant','setTimeoutAcrossTransitions','throttle'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za){var ab,bb;if(c.__markCompiled)c.__markCompiled();var cb=r.Types,db=r.Labels,eb=[cb.TOP_MATCHES,cb.TRENDING],fb='/graphsearch/',gb='/keywords_',hb='keywords_top',ib='gsv2',jb='group',kb=null,lb=null,mb=false,nb={};ab=babelHelpers.inherits(ob,ka.Component);bb=ab&&ab.prototype;function ob(pb){'use strict';bb.constructor.call(this,pb);this.setResultsHeight=this.setResultsHeight.bind(this);this.invokeQueryChange=this.invokeQueryChange.bind(this);this.onFormSubmit=this.onFormSubmit.bind(this);this.onSearchButtonDummyClick=this.onSearchButtonDummyClick.bind(this);this.onInputChange=this.onInputChange.bind(this);this.onInputFocus=this.onInputFocus.bind(this);this.onInputBlur=this.onInputBlur.bind(this);this.onClearButtonEvent=this.onClearButtonEvent.bind(this);this.onResultsWrapperTouchMove=this.onResultsWrapperTouchMove.bind(this);this.onAddToInputClick=this.onAddToInputClick.bind(this);this.onResultClick=this.onResultClick.bind(this);this.onEditRecentClick=this.onEditRecentClick.bind(this);if(pb.bootload)this.initializeXHPElements();var qb=this.getInitialQuery(pb),rb=this.getInitialSearchMode(),sb=this.getInitialGroupID();this.state={query:qb||this.props.prefilledValue||'',prefilledValue:this.props.prefilledValue||'',results:[],isWaiting:false,isActive:false,isVisible:qb!=null||this.props.prefilledValue!=null,resultClicked:false,searchMode:rb,prevSearchMode:rb,querySource:null,filterEnabled:false,qpMegaphoneDismissed:false,isInputFocused:false,groupID:sb,groupName:this.props.groupName};}ob.prototype.shouldComponentUpdate=function(pb,qb){'use strict';return qb.query!==this.state.query||qb.isWaiting!==this.state.isWaiting||qb.isActive!==this.state.isActive||qb.isVisible!==this.state.isVisible||qb.results.length!==this.state.results.length||qb.results.some(function(rb,sb){return rb.id!==this.state.results[sb].id||rb.display!=this.state.results[sb].display;}.bind(this))||qb.searchMode!==this.state.searchMode||qb.filterEnabled!==this.state.filterEnabled||qb.qpMegaphoneDismissed!==this.state.qpMegaphoneDismissed;};ob.prototype.componentWillMount=function(){'use strict';if(lb)this.applyPayload(lb);this.$MGraphSearchTypeahead1=new pa();this.$MGraphSearchTypeahead2=new q({maxResults:this.props.typeaheadConfig.compositeSourceConfig.maxResults});this.$MGraphSearchTypeahead3=null;this.$MGraphSearchTypeahead4={};this.$MGraphSearchTypeahead5=[];this.$MGraphSearchTypeahead6={};this.$MGraphSearchTypeahead7={};this.$MGraphSearchTypeahead8=this.props.filters;this.invokeQueryChangeThrottled=za(this.invokeQueryChange,200);this.$MGraphSearchTypeahead9=null;this.$MGraphSearchTypeahead10=null;this.setResultsHeightThrottled=za(this.setResultsHeight,500);this.$MGraphSearchTypeahead1.addSubscriptions(na.listen('MGraphSearchTypeaheadOnDemandSource:keywordsLimitUpdate',null,function(pb){var qb=pb.getData().keywordsLimit;if(qb!=null)nb[pb.getData().value]=qb;}));if(this.props.qpMegaphone)this.$MGraphSearchTypeahead1.addSubscriptions(na.listen('click','m-megaphone-close',this.onDismissQPMegaphone.bind(this)));if(this.props.typeaheadConfig.hasTopNavSearch)this.$MGraphSearchTypeahead1.addSubscriptions(na.listen('setSearchText','graph-search-entry-point',this.onSetSearchText.bind(this)));};ob.prototype.componentWillUnmount=function(){'use strict';ta(this.$MGraphSearchTypeahead9);if(this.$MGraphSearchTypeahead3!=null){this.$MGraphSearchTypeahead11.release();if(this.$MGraphSearchTypeahead3!=null)this.$MGraphSearchTypeahead3.unbindFromTypeahead();}this.$MGraphSearchTypeahead4=null;if(this.$MGraphSearchTypeahead10)this.$MGraphSearchTypeahead10.remove();this.$MGraphSearchTypeahead1.release();this.$MGraphSearchTypeahead19.release();kb=null;};ob.prototype.componentDidMount=function(){'use strict';!!kb?xa(0):void 0;kb=this;if(this.props.filters)this.$MGraphSearchTypeahead1.addSubscriptions(na.listen('m-content-search-filter-update',null,this.onFilterUpdate.bind(this)));if(w.getParam(w.SOFT_STATE_KEY)===y.SEARCH){var pb={isActive:true,searchMode:v.getGlobalSearchMode()};if(this.state.isVisible&&this.state.query===''&&this.state.prevQuery){pb.query=this.state.prevQuery;pb.searchMode=this.getInitialSearchMode();}this.setState(pb,function(){var rb=this.getInputElement();rb&&rb.focus();}.bind(this));}this.$MGraphSearchTypeahead1.addSubscriptions(na.listen(['m:chrome:tab:show','m:chrome:tab:hide'],y.SEARCH,function(event){ya(function(){this.onChromeTabShowOrHide(event);}.bind(this),0);}.bind(this)),na.listen('m:page:loading',null,this.onMPageLoad.bind(this)),na.listen('click','m-groups-scoped-search-button',this.onGroupSearchActivation.bind(this)));var qb=n.getFilters();if(qb){j.setContent(this.$MGraphSearchTypeahead8.getContentRoot().querySelector("._5c0f"),qb);this.setState({filterEnabled:true});}this.$MGraphSearchTypeahead10=l.listen(window,'scroll',this.onWindowScroll.bind(this));this.mGraphSearchTypeaheadContainer=ja.bySelector(la.findDOMNode(this),"._3qs0");if(this.props.nuxSearchFollow!=null&&ia.getScrollTop()<2){this.props.nuxSearchFollow.setContext(la.findDOMNode(this.refs.searchButtonDummy));this.props.nuxSearchFollow.show();}this.positionSearchBox();this.$MGraphSearchTypeahead1.addSubscriptions(na.listen('m:graph-search:position-search-box',null,this.positionSearchBox.bind(this)),na.listen('MGraphSearchTypeahead:focus',null,this.onFocusRequest.bind(this)),na.listen('m:chrome:tab:show',null,this.onChromeTabShow.bind(this)));if(this.props.active)this.setState({query:this.props.prefilledValue||'',isActive:true,isVisible:true});if(this.props.bootload)this.initializeXHPElements();na.invoke('m:graph-search:ready');};ob.prototype.componentWillUpdate=function(pb,qb){'use strict';this.$MGraphSearchTypeahead20('render_start');if(w.getParam(w.SOFT_STATE_KEY)!==y.SEARCH&&!z.hasNavTabs){var rb=j.find(h(x.JEWEL_NAV_NODE_ID),'*','search');i.conditionClass(rb,'isActive',qb.isVisible);}};ob.prototype.componentDidUpdate=function(pb,qb){'use strict';this.$MGraphSearchTypeahead5=qb.results;if(this.state.isActive){this.setResultsHeightThrottled();}else if(qb.isActive&&!this.state.isActive)oa.set(document.getElementById('page'),'height',null);if(!this.$MGraphSearchTypeahead12&&!pb.isVisible&&this.state.isVisible){this.configureDatasource(ma);this.configureMSideNavMarauderLogger();this.configureMSearchTypeaheadLogger();this.configureMSearchTypeaheadPerfLogger();this.configureMRecentSearchesUpdater();var rb=ga.hasTouchEvents()?'touchend':'click';na.invoke(rb,'graph-search-activator');this.$MGraphSearchTypeahead20('change',[this.state.query]);this.$MGraphSearchTypeahead12=true;}else if(qb.searchMode!==this.state.searchMode){this.configureDatasource(ma,true);this.configureMSearchTypeaheadPerfLogger();this.invokeQueryChange();}this.$MGraphSearchTypeahead20('rendered');};ob.prototype.render=function(){'use strict';var pb=this.props.typeaheadConfig.hasTopNavSearch,qb=!!this.props.filters&&this.state.filterEnabled&&!this.state.isActive,rb=v.getPlaceholder(Object.assign({},this.props,this.state)),sb=ka.createElement('form',{ref:'form',className:"_bjg",onSubmit:this.onFormSubmit,action:'/search'},ka.createElement('div',{className:"_31vt",ref:'searchButtonDummy','data-sigil':'search-small-box-dummy',onClick:this.onSearchButtonDummyClick}),ka.createElement('div',{ref:'inputWrapper',className:"_bjh"},ka.createElement('input',{ref:'input',id:'main-search-input','data-sigil':'search-small-box',className:"_bji",type:'search',name:'query',placeholder:rb,autoComplete:'off',autoCorrect:'off',autoCapitalize:'off',onChange:this.onInputChange,onFocus:this.onInputFocus,onBlur:this.onInputBlur,value:this.state.query}),ka.createElement('label',{htmlFor:'main-search-input',className:"_3a7l"},wa._("\u641c\u5c0b")),ka.createElement('a',{href:'#',className:"_bjj",style:{display:!this.state.query||!this.state.isInputFocused?'none':''},role:'button',onMouseDown:this.onClearButtonEvent,onTouchStart:this.onClearButtonEvent},'×')),ka.createElement('a',{href:'#',className:"_mq5",'data-sigil':'touchable m_content_search_filter_button',style:{display:qb?'block':'none'},role:'button'})),tb=v.getContainerClasses({hasFilterButton:qb,hasTopNavSearch:pb,isActive:this.state.isActive,isVisible:this.state.isVisible,isWaiting:this.state.isWaiting,vertical:this.props.vertical,withQuery:this.state.query!=null&&this.state.query!==''}),ub=this.renderResultsComponents(),vb=null;if(this.props.qpMegaphone&&!this.state.qpMegaphoneDismissed)vb=ka.createElement('div',{className:"_406x"},ka.createElement(k,null,this.props.qpMegaphone));var wb=ka.createElement('div',{ref:'results',className:"_bjs"},vb,ub);if(this.props.bootload){this.getContainerElement().className=tb;return (ka.createElement('div',{className:"_bjr",onTouchMove:this.onResultsWrapperTouchMove,onTouchStart:this.onResultsWrapperTouchMove},wb));}else return (ka.createElement('div',{className:tb},sb,ka.createElement('div',{className:"_bjr",onTouchMove:this.onResultsWrapperTouchMove,onTouchStart:this.onResultsWrapperTouchMove},wb)));};ob.prototype.injectSeeMore=function(pb){'use strict';if(!this.state.query)return pb;var qb=pb.findIndex(function(sb){return sb.isSeeMore;});if(qb!==-1)pb.splice(qb,1);var rb={id:'seeMore',type:'keyword',isSpecialIntentGeneric:true,isSeeMore:true,display:this.state.query,uri:this.getSeeMoreURI(this.state.query).toString()};pb.push(rb);return pb;};ob.prototype.onChromeTabShow=function(event){'use strict';if(event.getPath()==='search')this.setState({isActive:true,isVisible:true},function(){this.getInputElement().focus();});};ob.prototype.onFocusRequest=function(){'use strict';this.getInputElement().focus();};ob.prototype.onDismissQPMegaphone=function(){'use strict';if(!this.state.isVisible)return;this.setState({qpMegaphoneDismissed:true});};ob.prototype.onGroupSearchActivation=function(pb){'use strict';var qb=pb.getTarget(),rb=qb.getAttribute('data-ft'),sb=qb.getAttribute('data-name');if(!rb||!sb)return;this.setState({searchMode:jb,groupID:rb,groupName:sb,isVisible:true,isActive:true,refURI:window.location.href,results:[]});this.getInputElement().focus();};ob.prototype.getHeaderTypeForResult=function(pb){'use strict';if(pb.isTrending){return cb.TRENDING;}else if(pb.isRecentSearch){return cb.RECENT;}else if(pb.type==='keyword'){return cb.SUGGESTED;}else return cb.TOP_MATCHES;};ob.prototype.renderResultsComponents=function(){'use strict';var pb=this.props.typeaheadConfig.defaultNumTopResultsToShow;if(nb[this.state.query]!=null)pb=nb[this.state.query];this.injectSeeMore(this.state.results);var qb=this.state.results,rb=this.$MGraphSearchTypeahead2.bucketize(qb,pb,this.props.typeaheadConfig.hasKeywordsFirst),sb=[],tb=[],ub=-1,vb=[],wb=true,xb=0,yb=[];Object.keys(rb).forEach(function(zb){var ac=rb[zb];if(zb===cb.SUGGESTED&&cb.GROUP_SEARCH in rb)zb=cb.SUGGESTED_GLOBAL;var bc=this.renderHeader(zb,wb);if(bc!=null)vb.push(bc);wb=false;var cc=ac.map(function(dc,ec){yb.push(dc);if(this.state.isVisible&&dc.isTrending&&dc.isNullStateSuggestion){sb[xb]=dc.topicID;tb[xb]=xb+1;ub=dc.trendingQueryID;}var fc=sa(eb,zb)||ec===ac.length-1;return this.renderResult(dc,fc);}.bind(this));vb.push.apply(vb,cc);}.bind(this));this.$MGraphSearchTypeahead20('show',[yb,{preventSessionStart:true}]);if(sb.length>0&&!mb){mb=true;da.registerTrendingTopicListeners(sb,ca.msite_news_null_state,tb,ub);da.logTrendingTopicImpressions(sb,ca.msite_news_null_state,tb,ub);}else mb=false;return vb;};ob.prototype.positionSearchBox=function(){'use strict';oa.set(la.findDOMNode(this),'top',ia.getHeaderTop()+'px');};ob.prototype.getSeeMoreText=function(pb){'use strict';if(this.props.vertical===ca.content_search)return this.state.query;var qb=this.state.query.trim();return wa._("\u641c\u5c0b{query}",[wa.param('query','"'+qb+'"')]);};ob.prototype.getDefaultSource=function(){'use strict';return this.state.querySource?this.state.querySource:'typeahead';};ob.prototype.renderResult=function(pb,qb){'use strict';var rb=this.state.results.indexOf(pb),sb=pb!=null,tb='typeahead';if(sb&&pb.uri)if(this.redirectPages&&pb.type=='page'){pb.uriWithSession=new qa('/search/').addQueryData('query',pb.name).addQueryData('tsid',this.$MGraphSearchTypeahead13).addQueryData('source',tb).toString();}else pb.uriWithSession=new qa(pb.uri).addQueryData({tsid:this.$MGraphSearchTypeahead13,source:tb}).toString();if(!sb)pb=this.$MGraphSearchTypeahead5[rb]||{};if(pb.isTrending)pb.uriWithSession=new qa(pb.uriWithSession).addQueryData('position',rb+1).toString();var ub=pb.id+(pb.isInvalidated===true?'invalidated':'');return (ka.createElement(t,{key:ub,onClick:this.onResultClick,onAddToInputClick:this.onAddToInputClick,query:this.state.query,result:pb,vertical:this.props.vertical,visible:sb,forceLongBorder:qb,typeaheadConfig:this.props.typeaheadConfig}));};ob.prototype.renderHeader=function(pb,qb){'use strict';if(pb===cb.RECENT)return this.renderRecentHeader();if(this.state.query===''||this.state.searchMode===jb){return (ka.createElement('div',{className:"_tn0",key:pb},db[pb]));}else if(!qb)return (ka.createElement('div',{className:"_2p41",key:pb}));return null;};ob.prototype.renderRecentHeader=function(){'use strict';return (ka.createElement(m,{key:cb.RECENT,direction:'right',className:"_tn0"},db[cb.RECENT],ka.createElement('a',{href:this.props.activityLogURI,onClick:this.onEditRecentClick,className:"_2186"},wa._("\u7de8\u8f2f"))));};ob.prototype.onEditRecentClick=function(){'use strict';this.recentSearchesNeedsUpdate=true;};ob.prototype.clear=function(){'use strict';var pb=this.getInputElement(),qb='';pb.value=qb;this.setState({query:qb});this.$MGraphSearchTypeahead20('change',[qb]);this.$MGraphSearchTypeahead20('update',[qb]);};ob.prototype.cancel=function(){'use strict';var pb=this.getInputElement();pb.blur();na.invoke('log-m-search-session-end',null,{reason:'cancel'});var qb=this.state.prefilledValue||'';this.setState({query:qb,isActive:false,isVisible:!!qb,searchMode:this.getInitialSearchMode()});this.$MGraphSearchTypeahead20('change',[qb]);this.$MGraphSearchTypeahead20('update',[qb]);};ob.prototype.getValue=function(){'use strict';return this.getInputElement().value;};ob.prototype.getDatasource=function(){'use strict';return this.$MGraphSearchTypeahead3;};ob.prototype.$MGraphSearchTypeahead21=function(pb){'use strict';this.$MGraphSearchTypeahead3=pb;this.$MGraphSearchTypeahead11=new pa();this.$MGraphSearchTypeahead11.addSubscriptions(pb.listen('req_dispatch',this.onDatasourceRequestDispatch.bind(this)),pb.listen('resultsready',this.onDatasourceResultsReady.bind(this)),pb.listen('after_complete',this.onDatasourceAfterComplete.bind(this)));pb.bindToTypeahead(this);};ob.prototype.$MGraphSearchTypeahead22=function(){'use strict';return this.props.typeaheadConfig;};ob.prototype.$MGraphSearchTypeahead23=function(){'use strict';return this.state.searchMode;};ob.prototype.configureDatasource=function(pb,qb){'use strict';if(this.$MGraphSearchTypeahead3!=null&&!qb)return;var rb=this.$MGraphSearchTypeahead3;if(rb!=null){this.$MGraphSearchTypeahead11.release();rb.unbindFromTypeahead();}var sb=this.$MGraphSearchTypeahead23(),tb=void 0;if(sb!=null)this.$MGraphSearchTypeahead6[sb];if(tb){this.$MGraphSearchTypeahead21(tb);this.$MGraphSearchTypeahead20('refresh');return;}var ub=this.$MGraphSearchTypeahead22().sources,vb=[],wb=void 0;if(ub.bootstrapped&&this.state.searchMode!==jb){wb=this.getTypeaheadTouchSource(ub.bootstrapped.src,ub.bootstrapped.source_key);wb.setShowSecondaryAction(true);wb.reactRendered=true;this.touchSource=wb;vb.push(wb);}if(ub.nullstate){this.nullstateDataSource=this.getTypeaheadNullstateSource(ub.nullstate.src);this.nullstateDataSource.setMaximumResultCount(ub.nullstate.max_results);this.nullstateDataSource.setShowSecondaryAction(true);this.nullstateDataSource.reactRendered=true;this.nullstateDataSource.setCurrentProfileID(this.props.currentProfileID);if(this.state.searchMode===jb)this.nullstateDataSource.setEnableScoped(true);vb.push(this.nullstateDataSource);}var xb=ub.online;if(xb){wb=this.getTypeaheadOnDemandSource(xb.src);wb.setMaximumResultCount(xb.max_results);wb.setEnableImmediateReturnOfCachedResults(xb.enable_caching);wb.setMaxResults(this.props.typeaheadConfig.numResultsToFetch);if(pb){if(pb.enableQueryThrottle)wb.setThrottleSendRequest(pb.queryThrottleTime);wb.setEnableEagerSendRequest(pb.enableEagerSendRequest);wb.setQueryDelay(pb.queryWaitTime);this.redirectPages=pb.redirectPages;}wb.setShowSecondaryAction(true);wb.reactRendered=true;vb.push(wb);}rb=this.getTypeaheadCompositeSource(vb);rb.reactRendered=true;rb.mergeKey='id';this.$MGraphSearchTypeahead21(rb);this.$MGraphSearchTypeahead20('start');this.$MGraphSearchTypeahead6[sb]=this.$MGraphSearchTypeahead3;};ob.prototype.getTypeaheadCompositeSource=function(pb){'use strict';var qb=new o(pb);qb.setConfig(this.props.typeaheadConfig.compositeSourceConfig);return qb;};ob.prototype.getTypeaheadOnDemandSource=function(pb){'use strict';pb=new s(pb,{disableLongerQueryCacheHit:this.props.typeaheadConfig.disableLongerQueryCacheHit,showSecondaryPhoto:this.props.showSecondaryPhoto,numResultsToFetch:this.props.typeaheadConfig.numResultsToFetch});if(this.state.searchMode===jb){pb.setIsScoped(true);pb.setGroupID(this.state.groupID);}return pb;};ob.prototype.getTypeaheadTouchSource=function(pb,qb){'use strict';return new u(pb,qb);};ob.prototype.getTypeaheadNullstateSource=function(pb){'use strict';return new ha(pb);};ob.prototype.getTypeaheadType=function(){'use strict';var pb='m_top_nav_gsv2';if(this.props.typeaheadConfig.hasTopNavSearch)pb+='_small_box';return pb;};ob.prototype.configureMSideNavMarauderLogger=function(){'use strict';if(!this.props.typeaheadConfig.mSideNavMarauderLogger||this.$MGraphSearchTypeahead14)return;this.props.typeaheadConfig.mSideNavMarauderLogger.setupTypeaheadListener(this);this.$MGraphSearchTypeahead14=true;};ob.prototype.configureMSearchTypeaheadLogger=function(){'use strict';if(this.$MGraphSearchTypeahead15)return;this.$MGraphSearchTypeahead1.addSubscriptions(na.listen('m-typeahead-logger:new-session-id',null,this.onMTypeaheadLoggerNewSessionId.bind(this)));var pb='/search/metrics.php',qb=new ea(this,pb);this.$MGraphSearchTypeahead15=true;this.$MGraphSearchTypeahead1.addSubscriptions(na.listen('log-m-search-session-end',null,function(rb){qb.blur(rb.getData().reason);}));};ob.prototype.configureMRecentSearchesUpdater=function(){'use strict';if(this.props.typeaheadConfig.hasRecentSearches)this.$MGraphSearchTypeahead16=new ba(this);};ob.prototype.configureMSearchTypeaheadPerfLogger=function(){'use strict';var pb=this.$MGraphSearchTypeahead23();if(pb!=null&&(!this.props.typeaheadConfig.typeaheadScubaInfo||this.$MGraphSearchTypeahead7[pb]))return;this.$MGraphSearchTypeahead17=new fa(this,this.props.typeaheadConfig.typeaheadScubaInfo,this.props.typeaheadConfig.sources.online.enable_caching);this.$MGraphSearchTypeahead7[pb]=true;};ob.prototype.invokeKeypressed=function(){'use strict';var pb=this.getInputElement().value;this.$MGraphSearchTypeahead20('keypress',[pb]);};ob.prototype.invokeQueryChange=function(){'use strict';var pb=this.getInputElement().value;this.$MGraphSearchTypeahead20('update',[pb]);this.$MGraphSearchTypeahead20('change',[pb]);};ob.prototype.listen=function(pb,qb){'use strict';var rb=this.$MGraphSearchTypeahead4;!(rb!=null)?xa(0):void 0;rb[pb]=rb[pb]||[];rb[pb].push(qb);return {type:pb,callback:qb,remove:function(){!(rb!=null)?xa(0):void 0;rb[pb]=rb[pb].filter(function(sb){return sb!==qb;});}};};ob.prototype.$MGraphSearchTypeahead20=function(pb,qb){'use strict';qb=qb||[];var rb=this.$MGraphSearchTypeahead4;!(rb!=null)?xa(0):void 0;if(rb[pb])rb[pb].forEach(function(sb){sb.apply(this,qb);}.bind(this),this);};ob.prototype.onInputChange=function(){'use strict';var pb=this.getInputElement().value;this.setState({query:pb,querySource:null});this.invokeKeypressed();this.invokeQueryChangeThrottled();};ob.prototype.onInputBlur=function(){'use strict';this.setState({isInputFocused:false});};ob.prototype.onInputFocus=function(){'use strict';this.setState({isInputFocused:true});if(!z.hasNavTabs)w.pushSoftState(y.SEARCH);var pb=this.getInputElement().value,qb=new qa(window.location),rb=new qa(this.props.activityLogURI);if(this.recentSearchesNeedsUpdate||qb.getPath()===rb.getPath()){this.recentSearchesNeedsUpdate=false;this.$MGraphSearchTypeahead20('refreshRecent',[pb]);}this.setState({isActive:true,isVisible:true,prevSearchMode:this.state.searchMode});if(this.$MGraphSearchTypeahead12){var sb=ga.hasTouchEvents()?'touchend':'click';na.invoke(sb,'graph-search-activator');}this.$MGraphSearchTypeahead20('focus');this.$MGraphSearchTypeahead20('change',[pb]);};ob.prototype.onClearButtonEvent=function(event){'use strict';event.preventDefault();this.getInputElement().focus();this.setState({prevQuery:this.state.query});this.clear();};ob.prototype.onResultClick=function(event){'use strict';var pb=this.getResultLinkFromTarget(event.target),qb=this.getResultFromResultLink(pb),rb={isActive:false,isVisible:qb.type==='keyword',resultClicked:true,prefilledValue:'',query:''};rb.query=qb.type==='keyword'?qb.display:'';rb.prefilledValue=rb.query;this.setState(rb);this.$MGraphSearchTypeahead20('select',[pb]);};ob.prototype.onAddToInputClick=function(event){'use strict';event.preventDefault();event.stopPropagation();var pb=this.getResultFromResultLink(this.getResultLinkFromTarget(event.target)),qb=pb.display+' ';this.$MGraphSearchTypeahead20('change',[qb]);this.setState({query:qb});};ob.prototype.onSeeMoreClick=function(){'use strict';this.handleSeeMoreClick(false);};ob.prototype.onSimpleSearchSeeMoreClick=function(){'use strict';this.handleSeeMoreClick(true);};ob.prototype.handleSeeMoreClick=function(pb){'use strict';var qb=this.getInputElement(),rb=qb.value;this.setState({resultClicked:true,prefilledValue:rb,isActive:false,isVisible:!!rb});var sb='';this.$MGraphSearchTypeahead20('query',[this.state.results,sb]);};ob.prototype.onFormSubmit=function(event){'use strict';event.preventDefault();var pb=this.getInputElement(),qb=pb.value,rb='';if(qb==='')return false;rb=this.getSubmitURI(qb);rb=rb.addQueryData('tsid',this.$MGraphSearchTypeahead13).addQueryData('source',this.getDefaultSource()).toString();aa.load(rb);this.setState({prefilledValue:qb,isActive:false,isVisible:!!qb,resultClicked:true});this.$MGraphSearchTypeahead20('query',[this.state.results]);pb.blur();return null;};ob.prototype.getGraphSearchURI=function(pb){'use strict';pb=pb.trim();if(this.state.searchMode===jb)return ra.getURIBuilder().setInt('groupID',this.state.groupID).setString('query',pb).getURI();var qb=new qa(window.location),rb=qb.getPath();if(rb.indexOf(fb)===0&&rb.lastIndexOf(gb)!=-1&&this.props.vertical!==ca.content_search){hb=rb.substring(rb.lastIndexOf(gb)+1);var sb=hb.indexOf('/');if(sb!==-1)hb=rb.substring(0,sb);}if(hb==='keywords_top')return new qa('/search/top/').addQueryData('q',pb);return new qa('/graphsearch/str/'+encodeURIComponent(pb)+'/'+hb);};ob.prototype.getAllFriendsURI=function(pb){'use strict';return new qa('/graphsearch/str/'+pb+'/keywords_users');};ob.prototype.getSubmitURI=function(pb){'use strict';return this.getGraphSearchURI(pb).addQueryData('ref','content_filter');};ob.prototype.getSeeMoreURI=function(pb){'use strict';pb=pb.trim();if(this.state.searchMode===ib)return this.getGraphSearchURI(pb);var qb=new qa('/search/?query').addQueryData({query:pb,refid:ca.refid});return qb;};ob.prototype.onResultsWrapperTouchMove=function(){'use strict';this.getInputElement().blur();};ob.prototype.onSearchButtonDummyClick=function(){'use strict';if(this.props.nuxSearchFollow)this.props.nuxSearchFollow.hide();this.getInputElement().focus();};ob.prototype.onDatasourceRequestDispatch=function(){'use strict';this.setState({isWaiting:true});};ob.prototype.injectKeywordEchoQuery=function(pb){'use strict';if(this.state.query===''||this.props.vertical!==ca.content_search||this.props.removeEchoQuery)return pb;var qb=pb.findIndex(function(vb){return vb.id=='echo-query';});if(qb!==-1)pb.splice(qb,1);var rb=pb.some(function(vb){return vb&&vb.type==='keyword'&&vb.display&&vb.display.toLowerCase().trim()===this.state.query.toLowerCase().trim();}.bind(this));if(rb)return pb;var sb=this.getSeeMoreURI(this.state.query).toString(),tb=wa._("\u9ede\u6309\u5373\u53ef\u641c\u5c0b Facebook"),ub={id:'echo-query',type:'keyword',display:String(this.getSeeMoreText()),uri:sb,subtext:tb,exactMatchKeyword:true};pb.push(ub);return pb;};ob.prototype.onDatasourceResultsReady=function(pb){'use strict';pb=this.injectKeywordEchoQuery(pb);if(this.props.typeaheadConfig.hasFlickerFix)pb=p.insert(this.state.query,pb,this.state.isWaiting);this.setState({results:pb});pb.forEach(function(qb){qb.uri=new qa(qb.uri).addQueryData('refid',ca.refid);return qb;});};ob.prototype.onDatasourceAfterComplete=function(){'use strict';this.setState({isWaiting:false});};ob.prototype.onFilterUpdate=function(event){'use strict';var pb=n.getFilters();if(!pb)return;j.setContent(this.$MGraphSearchTypeahead8.getContentRoot().querySelector("._5c0f"),pb);this.setState({filterEnabled:true});};ob.prototype.onSetSearchText=function(event){'use strict';var pb=event.getData().title||'';this.$MGraphSearchTypeahead20('change',[pb,{preventSessionStart:true}]);this.setState({query:pb,prefilledValue:pb,isActive:false,isVisible:pb!=='',searchMode:this.getInitialSearchMode()});};ob.prototype.onMTypeaheadLoggerNewSessionId=function(pb){'use strict';if(!this.getFormElement())return;var qb=la.findDOMNode(this.getFormElement()),rb=j.scry(qb,'input','search-typeahead-session-id')[0];if(!rb){rb=document.createElement('input');rb.type='hidden';rb.name='tsid';qb.appendChild(rb);na.addSigil(rb,'search-typeahead-session-id');}var sb=pb.getData().sessionID;rb.value=sb;this.$MGraphSearchTypeahead13=sb;};ob.prototype.onWindowScroll=function(event){'use strict';if(this.state.isVisible)this.$MGraphSearchTypeahead20('scroll',[event]);};ob.prototype.onMPageLoad=function(){'use strict';if(this.$MGraphSearchTypeahead8){this.$MGraphSearchTypeahead8.hide();this.setState({filterEnabled:false});}this.$MGraphSearchTypeahead9=ya(this.reset.bind(this),0);};ob.prototype.reset=function(){'use strict';var pb=this.getInputElement();if(pb!=null)pb.blur();if(!this.state.resultClicked){this.setState({isVisible:false,isActive:false,query:'',prefilledValue:'',searchMode:this.getInitialSearchMode()});}else this.setState({resultClicked:false});};ob.prototype.getResultLinkFromTarget=function(pb){'use strict';var qb=ja.bySelector(pb,"._1w-s");return qb.querySelector("._4rh3");};ob.prototype.getResultFromResultLink=function(pb){'use strict';var qb=this.state.results.filter(function(rb){return rb.id===pb.getAttribute('rel');})[0]||{};return qb;};ob.prototype.setResultsHeight=function(){'use strict';var pb=la.findDOMNode(this.refs.results).offsetHeight+la.findDOMNode(this.refs.results).offsetTop;if(pb&&this.$MGraphSearchTypeahead18){var qb=la.findDOMNode(this.$MGraphSearchTypeahead18.container).offsetHeight;oa.set(document.getElementById('page'),'height',pb+qb+'px');}};ob.prototype.applyPayload=function(pb){'use strict';if(pb.active)na.listen(['m:onload','m:page:render:complete'],null,function(){na.removeCurrentListener();lb=null;var qb=this.state.searchMode;this.setState({isActive:true,isVisible:true,searchMode:qb});}.bind(this));};ob.prototype.getInitialSearchMode=function(){'use strict';return v.getInitialSearchMode();};ob.prototype.getInitialGroupID=function(){'use strict';var pb=new qa(window.location);return pb.getQueryData().groupID;};ob.prototype.getInitialQuery=function(){'use strict';return this.props.bootload?this.props.elements.input.value:null;};ob.prototype.onChromeTabShowOrHide=function(event){'use strict';var pb={isActive:event.getType()==='m:chrome:tab:show'};if(event.getData().open)pb.searchMode=v.getGlobalSearchMode();if(this.state.isVisible&&this.state.query===''&&this.state.prevQuery){pb.query=this.state.prevQuery;pb.searchMode=this.getInitialSearchMode();}this.setState(pb);if(pb.isActive){var qb=this.getInputElement();qb&&qb.focus();}else this.reset();if(event.getType()==='m:chrome:tab:hide')na.invoke('log-m-search-session-end',null,{reason:'navigated_away'});};ob.prototype.getInputElement=function(){'use strict';return this.props.bootload?this.$MGraphSearchTypeahead18.input:la.findDOMNode(this.refs.input);};ob.prototype.getFormElement=function(){'use strict';return this.props.bootload?this.$MGraphSearchTypeahead18.form:la.findDOMNode(this.refs.form);};ob.prototype.getContainerElement=function(){'use strict';return this.props.bootload?this.$MGraphSearchTypeahead18.container:la.findDOMNode(this.refs.container);};ob.prototype.initializeXHPElements=function(){'use strict';this.$MGraphSearchTypeahead19=new pa();this.$MGraphSearchTypeahead18={container:this.props.elements.container,input:this.props.elements.input,form:this.props.elements.form,clear:this.props.elements.clear};var pb=this.props.elements.input,qb=this.props.elements.clear,rb=this.props.elements.form;this.$MGraphSearchTypeahead19.addSubscriptions(l.listen(pb,'focus',this.onInputFocus),l.listen(pb,'blur',this.onInputBlur),l.listen(pb,'keydown',this.onInputChange),l.listen(qb,'touchstart',this.onClearButtonEvent),l.listen(qb,'mousedown',this.onClearButtonEvent),l.listen(rb,'submit',this.onFormSubmit));};ob.update=function(pb){'use strict';if(kb&&pb){kb.applyPayload(pb);}else lb=pb;};f.exports=ob;},null);